import { ProviderError, ProviderFailure } from '../errors.js';
export const withProviderErrors = (providerImplementation, toProviderError) => Object.keys(providerImplementation).reduce((provider, key) => {
    const originalValue = providerImplementation[key];
    provider[key] =
        typeof originalValue === 'function'
            ? (...args) => originalValue(...args).catch(toProviderError)
            : originalValue;
    return provider;
}, {});
const tryParseBigIntKey = (key) => {
    if (key.startsWith('0x'))
        return key.slice(2);
    try {
        return BigInt(key);
    }
    catch {
        return key;
    }
};
export const jsonToMetadatum = (obj) => {
    switch (typeof obj) {
        case 'number':
            return BigInt(obj);
        case 'string':
        case 'bigint':
            return obj;
        case 'object': {
            if (obj === null)
                break;
            if (Array.isArray(obj)) {
                return obj.map(jsonToMetadatum);
            }
            return new Map(Object.keys(obj).map((key) => [tryParseBigIntKey(key), jsonToMetadatum(obj[key])]));
        }
    }
    throw new ProviderError(ProviderFailure.NotImplemented, null, `Unsupported metadatum type: ${typeof obj}`);
};
//# sourceMappingURL=providerUtil.js.map